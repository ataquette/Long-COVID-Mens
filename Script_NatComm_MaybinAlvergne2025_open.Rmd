---
title: 'Long COVID and menstruation: potential bidirectional associations and mechanisms:
  Study 1'
author: "Alex Alvergne"
date: "2025-07-24"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, include=TRUE, warning=FALSE, message=FALSE, results="hide", verbose=FALSE)
```


# Set up

### Packages load

```{r packages, results='hide'}

# Ensures the package "pacman" is installed
if (!require("pacman")) install.packages("pacman")
# Packages available from CRAN
##############################

## Load
library(pacman)
pacman::p_load(
     rio,         # import/export
     here,        # file locator
     purrr,       # iteration
     gtsummary,
     tidyverse,
     flextable,
     ggplot2,
     forcats,
     kableExtra,
     flextable,
     Hmisc,
     pbapply,
     mice,
     GGally,
     effects,
     gridExtra,
     grid,
     lattice,
     gtsummary,
     dplyr,
     DiagrammeR,
     reporter# to do the flowchart
    
)


```

### Data manipulation

#### Data load

```{r dataload}
data<-import(here("Natcomm_Maybin2025.Rda")) # imputed list
```


# Analysis Normal Cycle Parameters {.tabset .tabset-fade .tabset-pills}

##### Table

```{r tabledesc}
# create tbl objects
theme_gtsummary_journal(journal = "jama")
theme_gtsummary_compact()
tbl <- 
  tbl_summary(
    select(data[[1]], age, bmi_group, contra_current_groupall, covid_tested, 
           vaccinated, vaccine_type, income_before, nbdeliveries, covid_group),  # Add covid_group here
    by = covid_group,
    label = list(
      age ~ "Age",
      bmi_group ~ "Body Mass Index",
      contra_current_groupall ~ "Contraceptive use at the time of the survey", 
      covid_tested ~ "COVID status (diagnosis)", 
      vaccinated ~ "Number of vaccination shots", 
      vaccine_type ~ "Vaccine type",
      income_before ~ "Income",
      nbdeliveries ~ "Number of deliveries"
      # Remove covid_group from labels since it's the grouping variable
    )
  )

# beautify
tblbest<-tbl %>%
  modify_caption("Table 1. Summary of the sample characteristics") %>%
  bold_labels()

# convert gtsummary object into flextable to export to word
tblbest%>%
  as_flex_table()%>%
  flextable::save_as_docx(path = "Table1.docx") 



```

##### DAG

```{r dag_freq_normal, results='asis'}
p_load(dagitty)
p_load(ggdag)
p_load(ggplot2)


dagified <- dagify(cycle_lastyr ~ cyclechar_before_group + age + bmi + nbdeliveries + covid_group + contra +  disease_before_binary_num + stress,
                   cyclelength_before_group ~ age  + bmi  + disease_before_binary_num,
                   covid_group ~ age  + bmi +contra+disease_before_binary_num,
                   stress ~ covid_group,
                   nbdeliveries ~ age  ,
                   contra ~ age + bmi,
                   labels = c(
                   "cyclechar_before_group" = "cycle\n characteristics\n before\n the\n pandemic", 
                   "cycle_lastyr" = "cycle\n characteristics\n during\n the\n pandemic", 
                   "nbdeliveries" = "number\n of\n deliveries",
                   "disease_before_binary_num"= "disease\n before\n",
                   "age" = "age",
                   "bmi" = "BMI",
                   "contra" = "contraceptive\n use",
                   "covid_group" = "covid\n group",
                   "stress" = "pandemic\n stress"),
                   exposure = "covid_group",
                   outcome = "cycle_lastyr")%>% 
  tidy_dagitty()


  

# plot adjustment
pdf("Dag_adjusted.pdf")
ggdag_adjustment_set(dagified, stylized = FALSE,text_size = 3,node_size = 25,use_labels = "label", text = FALSE,shadow = TRUE) +
  theme_dag()
dev.off()

```

# Frequency {.tabset .tabset-fade .tabset-pills}

##### Multivariate

```{r logistic_freq_normal, results='hide', echo=TRUE}
# multinomial
p_load(nnet) # for multinomial model

# set global R options
pboptions(type = "timer", char = "=") # initialize progress bar

# set list of exposures to test
exposures <- c(
    Cs(
        covid_group  +cyclelength_before_group+contra_past12mo_groupall+disease_before_binary_num
        
        
    )
)


 #model function - multivariate
 models <- function(x) {
     lapply(data, function(y)
         multinom(as.formula(
             paste0(
                 "cyclelength_lastyr_group ~ age_scaled + bmi_group + ",
                 x # exposure
            )
         ), data = y, model = TRUE)
     )
 }

## run  models
models_univariate <- as.list(seq(1,length(exposures))) # create list to store model results
models_univariate <- pblapply(exposures, models)





### Pool -------------------------------------------------------------------

pool_univariate <- as.list(seq(1,length(exposures))) # create list to store pool results

# run pool
for(j in seq_along(exposures)) {
    pool_univariate[[j]] <- pool(models_univariate[[j]])
}


#summary(D2(models_univariate[[1]], models_univariate[[2]]))


### Get the table ------------------------------------------------------

#### create report for model with age, bmi and contraceptive use
tab<-summary(pool_univariate[[1]])
##



# this is the FDR p values
tab$q.value <- p.adjust(tab$p.value,method = "BH")


#
tab2 <- tab %>% mutate(RRR = round (exp(estimate),2),
                      LowCI = round(exp (estimate - 1.96*std.error),2),
                      HighCI = round(exp (estimate + 1.96*std.error),2),
                      p.value = round ((p.value),4),
                      q.value = round ((q.value),4))%>%
                select(y.level ,term,RRR,LowCI,HighCI, p.value,q.value)



library(reporter)

tbl <- create_table(tab2) %>% 
  titles("Pooled Multivariate Models (Cycle Frequency) _LONGCOVID")
rpt <- create_report("Multi_full_Frequency_LONGCOVID.pdf", font_size=  8, output_type = "PDF") %>% 
  add_content(tbl)
write_report(rpt)






```

##### Plot

```{r plot_freq_normal, results="hide",  fig.width = 10}

#------------------------------------------------------------------------ plot predicted effect sizes


mod1<-multinom(cyclelength_lastyr_group ~ covid_group + cyclelength_before_group+age_group+ bmi_group +contra_past12mo_groupall+disease_before_binary_num, data=data[[1]])




# Plot combined#
# Save results
library(ggeffects)
library(ggsignif)
pprob_grplang <- ggeffect(mod1, terms = "covid_group",back.transform = TRUE)

# Plot summary model
ggcoef_multinom(mod1,
                type = "faceted",
                exponentiate = TRUE)

# Table
mod1 %>%
  tbl_regression(exponentiate = TRUE) %>%
  add_global_p(type = "II")



# Build plot
plot_freq_figo1_comb<-ggplot(data = pprob_grplang,
       aes(x = x, y = predicted,
           color = response.level, group = response.level)) +
  #geom_line() +
  geom_point() +
  ggtitle("Cycle frequency")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high,
                    color = response.level,
                    group = response.level),
                width = .1) +
  scale_color_brewer(palette = "Dark2",
                     name = "",
                     labels = c("Frequent",
                                "Infrequent",
                                "Normal")) +
  labs(
    x = "",
    y = "Predicted probability"
  ) +
  # Set the theme
  theme_minimal() +
  theme(
    legend.position = "bottom", # move legend to the bottom
    axis.title = element_text(size = 8),
        legend.text = element_text(size = 8),
# increase axis title size
  )

ggsave("plot_frequency_predicted_LONGCOVID.bmp",plot_freq_figo1_comb, width=5, height=5)


```

# Missed or stopped

#### Multivariate

```{r cyclefrequency, echo=TRUE}
# glm
p_load(nnet) # for multinomial model

# set global R options
pboptions(type = "timer", char = "=") # initialize progress bar

# set list of exposures to test
exposures <- c(
    Cs(
  covid_group  +contra_past12mo_groupall+disease_before_binary_num
    )
)


 #model function - multivariate
models <- function(x) {
    lapply(data, function(y)
        glm(as.formula(
            paste0(
                "stoppedperiods_lastyr ~ age_scaled + bmi_group + ",
                x
                
            )
        ), data = y, model=TRUE, family=binomial(link="log"))
    )
}


## run  models
models_univariate <- as.list(seq(1,length(exposures))) # create list to store model results
models_univariate <- pblapply(exposures, models)







### Pool -------------------------------------------------------------------

pool_univariate <- as.list(seq(1,length(exposures))) # create list to store pool results

# run pool
for(j in seq_along(exposures)) {
    pool_univariate[[j]] <- pool(models_univariate[[j]])
}


#### create report for cycle length before + contra + age + bmi + covidstatus
tab<-summary(pool_univariate[[1]])

tab$q.value <- p.adjust(tab$p.value,method = "BH")

tab2 <- tab %>% mutate(PR = round (exp(estimate),2),
                      LowCI = round(exp (estimate - 1.96*std.error),2),
                      HighCI = round(exp (estimate + 1.96*std.error),2),
                      p.value = round ((p.value),4),
                      q.value = round ((q.value),4))%>%
                select(term,PR,LowCI,HighCI, p.value, q.value)



library(reporter)

tbl <- create_table(tab2) %>% 
  titles("Pooled Multivariate Models (Periods Stopped)_LONGCOVID")
rpt <- create_report("Multi_full_Frequency_Stopped_LONGCOVID.pdf", font_size=  8, output_type = "PDF") %>% 
  add_content(tbl)
write_report(rpt)



```

#### Plot

```{r plot_miss, results="asis", results='hide', fig.width=8}

m<-glm(stoppedperiods_lastyr ~ age_group + bmi_group +cyclelength_before_group+ covid_group+disease_before_binary_num+contra_past12mo_groupall  , data=data[[1]], family=binomial(link="log"))

# Save results
pprob_grplang <- ggeffect(m, terms = "covid_group")

# 
# Plot summary model
#library(sjPlot)
#forest_miss<-plot_model(m, type=c("est"),show.values = TRUE, title="Periods Missed During the #Pandemic", colors="Set1",value.offset = 0.4, line.size = 1)+theme_minimal()
#ggsave("forest_miss_predicted_LONGCOVID.bmp",forest_miss, width=10, height=7)

# Build plot
plot_miss_figo_covax_comb<-ggplot(data = pprob_grplang,
       aes(x = x, y = predicted)) +
 # geom_line() +
  geom_point() +
  ggtitle("Period reported missed")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
                width = .1) +
  scale_color_brewer(palette = "Dark2") +
  labs(
    x = "",
    y = "Predicted probability"
  ) +
  # Set the theme
  theme_minimal() +
  theme(
    legend.position = "bottom", # move legend to the bottom
    axis.title = element_text(size = 8),
    legend.text = element_text(size = 8)
# increase axis title size
  )

ggsave("plot_frequency_stop_predictedLongCOVID.bmp",plot_miss_figo_covax_comb, width=5, height=5)

```


# Cycle Regularity {.tabset .tabset-fade .tabset-pills}

#### Model multivariate

```{r cyclereg}

# multinomial
p_load(nnet) # for multinomial model

# set global R options
pboptions(type = "timer", char = "=") # initialize progress bar

# set list of exposures to test
exposures <- c(
    Cs(
       covid_group  +cycle_irreg_before_group+contra_past12mo_groupall+disease_before_binary_num
    )
)



 #model function - multivariate
 models <- function(x) {
     lapply(data, function(y)
         multinom(as.formula(
             paste0(
                 "cyclelength_irregular_lastyr_group ~ age_scaled + bmi_group + ",
                 x # exposure
            )
         ), data = y, model=TRUE)
     )
 }

## run  models
models_univariate <- as.list(seq(1,length(exposures))) # create list to store model results
models_univariate <- pblapply(exposures, models)






### Pool -------------------------------------------------------------------

pool_univariate <- as.list(seq(1,length(exposures))) # create list to store pool results

# run pool
for(j in seq_along(exposures)) {
    pool_univariate[[j]] <- pool(models_univariate[[j]])
}




# Table
tab<-summary(pool_univariate[[1]])# put in model you want to see

tab$q.value <- p.adjust(tab$p.value,method = "BH")


tab2 <- tab %>% mutate(RRR = round (exp(estimate),2),
                      LowCI = round(exp (estimate - 1.96*std.error),2),
                      HighCI = round(exp (estimate + 1.96*std.error),2),
                      p.value = round ((p.value),4),
                      q.value= round ((q.value),4))%>%
                select(y.level ,term,RRR,LowCI,HighCI, p.value,q.value)


library(reporter)

tbl <- create_table(tab2) %>% 
  titles("Pooled Multivariate Models (Cycle Regularity)_LONGCOVID ")
rpt <- create_report("Multi_full_Regularity_LONGCOVID.pdf", font_size=  8, output_type = "PDF") %>% 
  add_content(tbl)
write_report(rpt)



```

#### Plot

```{r plot_cyclechanges, results="asis", results='hide', fig.width=14}

m<-multinom(cyclelength_irregular_lastyr_group  ~  age_group +covid_group+cycle_irreg_before_group+ bmi_group +disease_before_binary_num +contra_past12mo_groupall , data=data[[3]])

# Plot combined

# Save results
pprob_grplang <- ggeffect(m, terms = "covid_group")

##
# Plot summary model
#library(sjPlot)
#forest_reg<-plot_model(m, type=c("est"),show.values = TRUE, title="Cycle regularity During the Pandemic", colors="Set1",value.offset = 0.4, line.size = 1)+theme_minimal()
#ggsave("forest_reg_predicted_LONGCOVID.bmp",forest_reg, width=10, height=7)


# Build plot
plot_reg_figo1_comb<-ggplot(data = pprob_grplang,
       aes(x = x, y = predicted,
           color = response.level, group = response.level)) +
  #geom_line() +
  geom_point() +
  ggtitle("Cycle regularity")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high,
                    color = response.level,
                    group = response.level),
                width = .1) +
  scale_color_brewer(palette = "Dark2",
                     name = "",
                     labels = c("Irregular",
                                "Very Irregular",
                                "Regular")) +
  labs(
    x = "",
    y = "Predicted probability"
  ) +
  # Set the theme
  theme_minimal() +
  theme(
    legend.position = "bottom", # move legend to the bottom
    axis.title = element_text(size = 8),
            legend.text = element_text(size = 8)
# increase axis title size
  )

ggsave("plot_regularity_predicted_LONGCOVID.bmp",plot_reg_figo1_comb, width=5, height=5)


```

# Period Duration {.tabset .tabset-fade .tabset-pills}

#### Model multivariate

There is no effect of covid and vaccines

```{r period_duration,results='hide', echo=TRUE}

# set global R options
pboptions(type = "timer", char = "=") # initialize progress bar

# set list of exposures to test
exposures <- c(
    Cs(
         covid_group  +period_lengh_before_group+contra_past12mo_groupall+disease_before_binary_num
   
    )
)


 #model function - multivariate
 models <- function(x) {
     lapply(data, function(y)
         glm(as.formula(
             paste0(
                 "period_lengh_lastyr_group ~ age_scaled + bmi_group  + ",
                 x # exposure
            )
         ), data = y, family=binomial())
     )
 }

## run  models
models_univariate <- as.list(seq(1,length(exposures))) # create list to store model results
models_univariate <- pblapply(exposures, models)







### Pool -------------------------------------------------------------------

pool_univariate <- as.list(seq(1,length(exposures))) # create list to store pool results

# run pool
for(j in seq_along(exposures)) {
    pool_univariate[[j]] <- pool(models_univariate[[j]])
}



# all models together


# Table
tab<-summary(pool_univariate[[1]])

tab$q.value <- p.adjust(tab$p.value,method = "BH")


tab2 <- tab %>% mutate(PR = round (exp(estimate),2),
                      LowCI = round(exp (estimate - 1.96*std.error),2),
                      HighCI = round(exp (estimate + 1.96*std.error),2),
                      p.value = round ((p.value),4),
                      q.value = round ((q.value),4))%>%
                select(term,PR,LowCI,HighCI, p.value, q.value)


library(reporter)

tbl <- create_table(tab2) %>% 
  titles("Pooled Multivariate Models (Period Duration) LONG COVID ")
rpt <- create_report("Multi_full_Duration_LONGCOVID.pdf", font_size=  8, output_type = "PDF") %>% 
  add_content(tbl)
write_report(rpt)


```

#### Plot

```{r plot_p_duration, results='asis', message=FALSE}

m<-glm(period_lengh_lastyr_group ~ age_group+bmi_group  + covid_group+period_lengh_before_group +disease_before_binary_num+contra_past12mo_groupall, data=data[[1]], family=binomial)



# plot combined
# Save results
pprob_grplang <- ggeffect(m, terms = "covid_group")



# Build plot
plot_dur_figo_covax_comb<-ggplot(data = pprob_grplang,
       aes(x = x, y = predicted)) +
#  geom_line() +
  geom_point() +
  ggtitle("Period duration (8+ days)")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
                width = .1) +
  scale_color_brewer(palette = "Dark2") +
  labs(
    x = "",
    y = "Predicted probability"
  ) +
  # Set the theme
  theme_minimal() +
  theme(
    legend.position = "bottom", # move legend to the bottom
    axis.title = element_text(size = 8),
            legend.text = element_text(size = 8)
# increase axis title size
  )

ggsave("plot_dur_predicted_LONGCOVID.bmp",plot_dur_figo_covax_comb, width=5, height=5)



```

# Period Flow {.tabset .tabset-fade .tabset-pills}

#### Multivariate

```{r logistic_multi_periods,results='hide', echo=TRUE}
# multinomial
p_load(nnet) # for multinomial model

# set global R options
pboptions(type = "timer", char = "=") # initialize progress bar

# set list of exposures to test
exposures <- c(
    Cs(
   
    covid_group  +heavyperiod_before+contra_past12mo_groupall+disease_before_binary_num
   
        
    )
)


 #model function - multivariate
 models <- function(x) {
     lapply(data, function(y)
         multinom(as.formula(
             paste0(
                 "changesperiod_lastyr ~ age_scaled + bmi_group  +",
                 x # exposure
            )
         ), data = y, model = TRUE)
     )
 }

## run  models
models_univariate <- as.list(seq(1,length(exposures))) # create list to store model results
models_univariate <- pblapply(exposures, models)







### Pool -------------------------------------------------------------------

pool_univariate <- as.list(seq(1,length(exposures))) # create list to store pool results

# run pool
for(j in seq_along(exposures)) {
    pool_univariate[[j]] <- pool(models_univariate[[j]])
}


```

#### Table multivariate

```{r table_multi_periodchanges, results='asis'}

# Table
tab<-summary(pool_univariate[[1]])

tab$q.value <- p.adjust(tab$p.value,method = "BH")

tab2 <- tab %>% mutate(RRR = round (exp(estimate),2),
                      LowCI = round(exp (estimate - 1.96*std.error),2),
                      HighCI = round(exp (estimate + 1.96*std.error),2),
                      p.value = round ((p.value),4),
                     p.value = round ((q.value),4)) %>%
                select(y.level ,term,RRR,LowCI,HighCI, p.value,q.value)


library(reporter)

tbl <- create_table(tab2) %>% 
  titles("Pooled Multivariate Models (Period Flow) Long COVID")
rpt <- create_report("Multi_fullFlow_LONGCOVID.pdf", font_size=  8, output_type = "PDF") %>% 
  add_content(tbl)
write_report(rpt)
```

#### Plot

```{r plot_periodchanges, results="asis", results="hide", fig.width=8}

## plot
levels(data[[1]]$changesperiod_lastyr)[4]<-"Lighter and Heavier"

m<-multinom(changesperiod_lastyr  ~  age_scaled +covid_group+ bmi_group +disease_before_binary_num  , data=data[[1]])



# Save results
pprob_grplang <- ggeffect(m, terms = "covid_group")

# Build plot
plot_flow_figo_cov_comb<-ggplot(data = pprob_grplang,
       aes(x = x, y = predicted,
           color = response.level, group = response.level)) +
  #geom_line() +
  geom_point() +
  ggtitle("Period flow")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high,
                    color = response.level,
                    group = response.level),
                width = .1) +
  scale_color_brewer(palette = "Dark2",
                     name = "",
                     labels = c("Heavier",
                                "Lighter",
                                "Both",
                                "No changes")) +
  labs(
    x = "",
    y = "Predicted probability"
  ) +
  # Set the theme
  theme_minimal() +
  theme(
    legend.position = "bottom", # move legend to the bottom
    axis.title = element_text(size = 8),
            legend.text = element_text(size = 8)
# increase axis title size
  )

ggsave("plot_flow_predicted_LONGCOVID.bmp",plot_flow_figo_cov_comb, width=5, height=5)



```

# Interperiod bleeding

##### Multivariate

```{r logistic_IMB_normal ,  results='hide', echo=TRUE}

data[[1]]$changesspotting_lastyr<-relevel(data[[1]]$changesspotting_lastyr, ref = "No changes")
data[[2]]$changesspotting_lastyr<-relevel(data[[2]]$changesspotting_lastyr, ref = "No changes")
data[[3]]$changesspotting_lastyr<-relevel(data[[3]]$changesspotting_lastyr, ref = "No changes")
data[[4]]$changesspotting_lastyr<-relevel(data[[4]]$changesspotting_lastyr, ref = "No changes")
data[[5]]$changesspotting_lastyr<-relevel(data[[5]]$changesspotting_lastyr, ref = "No changes")

# multinomial
p_load(nnet) # for multinomial model

# set global R options
pboptions(type = "timer", char = "=") # initialize progress bar

# set list of exposures to test
exposures <- c(
    Cs(
        covid_group  +cyclelength_before_group+contra_past12mo_groupall+disease_before_binary_num))



 #model function - multivariate
 models <- function(x) {
     lapply(data, function(y)
         multinom(as.formula(
             paste0(
                 "changesspotting_lastyr ~ age_scaled + bmi_group + ",
                 x # exposure
            )
         ), data = y, model = TRUE)
     )
 }

## run  models
models_univariate <- as.list(seq(1,length(exposures))) # create list to store model results
models_univariate <- pblapply(exposures, models)





### Pool -------------------------------------------------------------------

pool_univariate <- as.list(seq(1,length(exposures))) # create list to store pool results

# run pool
for(j in seq_along(exposures)) {
    pool_univariate[[j]] <- pool(models_univariate[[j]])
}


#summary(D2(models_univariate[[1]], models_univariate[[2]]))


### Get the table ------------------------------------------------------

#### create report for model with age, bmi and contraceptive use
tab<-summary(pool_univariate[[1]])

tab$q.value <- p.adjust(tab$p.value,method = "BH")


tab2 <- tab %>% mutate(RRR = round (exp(estimate),2),
                      LowCI = round(exp (estimate - 1.96*std.error),2),
                      HighCI = round(exp (estimate + 1.96*std.error),2),
                      p.value = round ((p.value),4),
                      q.value = round ((q.value),4))%>%
                select(y.level ,term,RRR,LowCI,HighCI, p.value, q.value)



library(reporter)

tbl <- create_table(tab2) %>% 
  titles("Pooled Multivariate Models (Inter-Menstrual Bleeding) ")
rpt <- create_report("Multi_full_Spotting_LONGCOVID.pdf", font_size=  8, output_type = "PDF") %>% 
  add_content(tbl)
write_report(rpt)


##-------------------------------------------------------AIC models from 1st
library(modelsummary)
library(kableExtra)
library(gt)

```

##### Plot

```{r plot_IMB_normal, results="hide",  fig.width = 10}

#------------------------------------------------------------------------ plot predicted effect sizes

mod1<-multinom(changesspotting_lastyr ~ cyclelength_before_group +covid_group + age_group+ bmi_group +contra_past12mo_groupall+disease_before_binary_num, data=data[[1]])


# Save results
pprob_grplang <- ggeffect(mod1, terms = "covid_group")



# Build plot
plot_IMB_figo1_com<-ggplot(data = pprob_grplang,
       aes(x = x, y = predicted,
           color = response.level, group = response.level)) +
#  geom_line() +
  geom_point() +
  ggtitle("Inter-menstrual bleeding")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high,
                    color = response.level,
                    group = response.level),
                width = .1) +
  scale_color_brewer(palette = "Dark2",
                     name = "",
                     labels = c("Less",
                                "More",
                                "No changes",
                                "Both")) +
  labs(
    x = "",
    y = "Predicted probability"
  ) +
  # Set the theme
  theme_minimal() +
  theme(
    legend.position = "bottom", # move legend to the bottom
    axis.title = element_text(size = 8),
            legend.text = element_text(size = 8)
# increase axis title size
  )

ggsave("plot_IMB_predicted_LONGCOVID.bmp",plot_IMB_figo1_com, width=5, height=5)





```

# General Plot

```{r plot_all, results="asis", results="hide", fig.width=8}



 ## Plot covid predictd probabilities
p_load(ggpubr)


 
all<-ggarrange(
  plot_freq_figo1_comb,
  plot_reg_figo1_comb,
  plot_flow_figo_cov_comb,
  plot_dur_figo_covax_comb,
  plot_IMB_figo1_com,
  plot_miss_figo_covax_comb,
  labels = c("A", "B","C","D","E","F"),
  widths=c(5,5),
  heights=c(5,5,5),
  ncol=2,
  nrow=3)

 
ggsave("Figure1.bmp",all, width=12, height=14)
ggsave("Figure1.pdf",all, width=12, height=14)
ggsave("Figure1.jpeg",all, width=12, height=14)
ggsave("Figure1.png",all, width=7, height=8)

 


```
